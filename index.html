<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Calculadora de Chache de Shows">
    <meta name="author" content="Zonaro">

    <title>Calculadora de Cachê</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js"
        integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
        crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="cacheCalc.js"></script>
</head>

<body class="container">
    <h1>Calculadora de Cachê BeatFellas</h1>
    <form class="row">
        <div class="col-12">
            <label for="porcentagemBeatfellas">Cachê Bruto</label>
            <input class="form-control" type="number" name="cacheTotal" id="cacheTotal" />
        </div>
        <div class="col-12">
            <label for="porcentagemBeatfellas">Porcentagem da BeatFellas</label>

            <input class="form-control" type="number" min="1" max="100" value="10" name="porcentagemBeatfellas"
                id="porcentagemBeatfellas" />
        </div>
        <div class="col-12">

            <label for="comercial">Comercial (Quem fechou o show)</label>
            <select class="form-control" multiple name="comercial" id="comercial">
                <option value="Caxa">Caxa</option>
                <option value="Kaizonaro">Kaizonaro</option>
                <option value="Mautari" selected>Mautari</option>
            </select>
            <label for="porcentagemComercial">Porcentagem</label>

            <input class="form-control" type="number" min="1" max="100" value="20" name="porcentagemComercial"
                id="porcentagemComercial" />
        </div>
        <div class="col-12">

            <label for="produtores">Produtores (Quem resolve problemas e pendências diretamente com o contratante)</label>
            <select class="form-control" multiple name="produtores" id="produtores">
                <option value="Caxa">Caxa</option>
                <option value="Kaizonaro">Kaizonaro</option>
                <option value="Mautari" selected>Mautari</option>
            </select>
            <label for="porcentagemProdutores">Porcentagem</label>

            <input class="form-control" type="number" min="1" max="100" value="10" name="porcentagemProdutores"
                id="porcentagemProdutores" />
        </div>
        <div class="col-12">

            <label for="producao"> Produção (Quem ajudou na parte técnica, filmagem, som, foto etc)</label>
            <select class="form-control" multiple name="producao" id="producao">
                <option value="Gustavo" selected>Gustavo</option>
                <option value="Igor">Igor</option>
                <option value="Tucca">Tucca</option>
                <option value="Sara">Sara</option>
                <option value="Sara Rios">Sara Rios</option>
                <option value="Luis">Luis</option>

            </select>
            <label for="porcentagemProducao">Porcentagem</label>
            <input class="form-control" type="number" min="1" max="100" value="10" name="porcentagemProducao"
                id="porcentagemProducao" />
        </div>

        <div class="col-12">

            <label for="artista">Artista (Quem efetivamente tocou)</label>
            <select class="form-control" multiple name="artista" id="artista">
                <option value="Caxa" selected>Caxa</option>
                <option value="Kaizonaro" selected>Kaizonaro</option>
                <option value="Mautari" selected>Mautari</option>
            </select>
            <label for="porcentagemArtista">Porcentagem</label>
            <input class="form-control" type="number" min="1" max="100" value="50" name="porcentagemArtista"
                id="porcentagemArtista" />


        </div>

    </form>
    <table class="table">
        <thead>
            <tr>
                <th>
                    Nome
                </th>
                <th>Valor a Receber (R$)</th>
            </tr>
        </thead>
        <tbody id="result">

        </tbody>
    </table>
    <script>

        $(document).ready(function () {

        });

        $("select").select2({
            tags: true
        });

        $("form").submit(function (e) {

            e.preventDefault();

            let prods = $("#producao").val();
            let arts = $("#artista").val();
            let com = $("#comercial").val();
            let pd = $("#produtores").val();
            let cache = parseFloat($("#cacheTotal").val());
            let beatfellas = parseFloat($("#porcentagemBeatfellas").val());
            let por_art = parseFloat($("#porcentagemArtista").val());
            let por_prod = parseFloat($("#porcentagemProducao").val());
            let por_com = parseFloat($("#porcentagemComercial").val());
            let por_pd = parseFloat($("#porcentagemProdutores").val());

            $("#result").html("");

            if ((por_art + por_prod + por_com) == 100) {

                var tt = calcularCache(cache, prods, com, arts, pd, beatfellas, por_prod, por_com, por_art, por_pd);

                console.log("Calculado", tt);


                tt.totais.forEach(element => {
                    $("#result").append("<tr><td>" + element.nome + "</td><td>R$" + element.valor + "</td></tr>");
                });
            }

        });

        $(":input").on('change', function () {
            $('form').submit();
        })


    </script>
</body>